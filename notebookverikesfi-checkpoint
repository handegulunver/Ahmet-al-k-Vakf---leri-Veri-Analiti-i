{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45f74877-fafa-4a3b-94e6-cd8d925b313b",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c7646f24-c592-4e88-8d9e-6ab769d7ad5e",
   "metadata": {},
   "outputs": [],
   "source": [
    "file_path = \"data/elektrik_veri_hashed.xlsx\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "44156156-e381-48e7-9b56-c8d097130a60",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "os.listdir(\"../data\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "869824ae-f495-4df2-98a4-cfd039c252df",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "print(os.getcwd())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb2526ad-76ff-429c-a424-9167568a739d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "print(os.listdir(\"..\"))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1013cbea-6a3b-488d-81cb-e5cba1d541ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "pd.ExcelFile(file_path).sheet_names\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fa39ddd-3b70-49d5-9709-7e8bfbd12e8d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 0. ve 1. sayfalar: Tahsilat\n",
    "df_tahsilat = pd.read_excel(file_path, sheet_name=0)\n",
    "df_tahsilat_1 = pd.read_excel(file_path, sheet_name=1)\n",
    "\n",
    "# 2, 3, 4. sayfalar: Tahakkuk (3 ilçe)\n",
    "df_tahakkuk_1 = pd.read_excel(file_path, sheet_name=2)\n",
    "df_tahakkuk_2 = pd.read_excel(file_path, sheet_name=3)\n",
    "df_tahakkuk_3 = pd.read_excel(file_path, sheet_name=4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3808e261-e01e-485a-aaae-25f07d9d4067",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk_1.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d76bf41b-b8b6-4fc7-8925-9f0a0f182611",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk_2.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3b09faf7-c08d-464f-9885-f19a3635f184",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk_3.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a507970-8249-4579-8cd7-b66687bb10b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Tahsilat (Göynücek)\n",
    "df_tahsilat = pd.read_excel(file_path, sheet_name=0)\n",
    "\n",
    "# Tahakkuklar\n",
    "df_hamamozu = pd.read_excel(file_path, sheet_name=2)\n",
    "df_gumushacikoy = pd.read_excel(file_path, sheet_name=3)\n",
    "df_goynucek = pd.read_excel(file_path, sheet_name=4)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c13e2bb9-d534-4852-ae16-31cbb85c44f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_hamamozu[\"ilce\"] = \"Hamamözü\"\n",
    "df_gumushacikoy[\"ilce\"] = \"Gümüşhacıköy\"\n",
    "df_goynucek[\"ilce\"] = \"Göynücek\"\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "34991f3c-74f6-48aa-9c0c-187d4e9d60a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk = pd.concat(\n",
    "    [df_hamamozu, df_gumushacikoy, df_goynucek],\n",
    "    ignore_index=True\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e4ae1525-0bff-4d86-baa0-8520db2bf6f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8227cbb-7764-4561-83b2-77fdd0c8279f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk.info()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "66acecbf-7a3c-473a-bbfd-ae649d6cb2a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk[\"ilce\"].value_counts()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a95d3ae-6cae-4e4f-b28c-40daaa5ab214",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk[\"sozlesme_hesap_no\"].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fba2dd1f-b511-4eec-a2d6-3d0a4c452c2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tahakkuk.groupby(\"ilce\")[\"sozlesme_hesap_no\"].nunique()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cfd468e2-4c57-4ae3-a4f2-ae03b4386f41",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "668253f1-bcc8-4eb8-b3a9-d5abdba346d2",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.14.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
